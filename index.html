<!DOCTYPE html>
<html>
    <head>
        <title>makcro</title>
        <meta charset="utf-8" />
    </head>
    <body style="margin: 0%;">
        <pre id="content" style="white-space: pre-wrap;"></pre>
        <script type="text/javascript">
            let CLIENT_ID =
                '18830208597-7qaf4bhu75likfndk231vmaul0ckel01.apps.googleusercontent.com'
            let API_KEY = 'AIzaSyAoGzRKCqNlCalMF9nKk9UxGtBNygY8k6M'
            let DISCOVERY_DOCS = [
                'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'
            ]
            let SCOPES = 'https://www.googleapis.com/auth/drive'
            let initClient = () => {
                gapi.client
                    .init({
                        apiKey: API_KEY,
                        clientId: CLIENT_ID,
                        discoveryDocs: DISCOVERY_DOCS,
                        scope: SCOPES
                    })
                    .then(
                        () => {
                            if (
                                !gapi.auth2.getAuthInstance().isSignedIn.get()
                            ) {
                                gapi.auth2.getAuthInstance().signIn()
                            }
                            listFiles()
                        },
                        error => {
                            appendPre(JSON.stringify(error, null, 2))
                        }
                    )
            }
            let appendPre = message => {
                let textContent = document.createTextNode(message + '\n')
                document.getElementById('content').appendChild(textContent)
            }
            let uploadFile = () => {
                gapi.client.drive.files
                    .create(
                        {
                            resource: {
                                name: 'fileName',
                                mimeType: 'application/vnd.google-apps.folder'
                            },
                            fields: 'id'
                        },
                        function(err, file) {
                            if (err) {
                                console.error(err)
                            } else {
                                console.log('Folder Id: ', file.id)
                            }
                        }
                    )
                    .execute()
            }
            let listFiles = () => {
                gapi.client.drive.files
                    .list({
                        pageSize: 10,
                        fields: 'nextPageToken, files(id, name, mimeType)'
                    })
                    .then(response => {
                        appendPre('Files:')
                        let files = response.result.files
                        if (files && files.length > 0) {
                            for (let i = 0; i < files.length; i++) {
                                let file = files[i]
                                if (
                                    file.mimeType ==
                                    'application/vnd.google-apps.folder'
                                ) {
                                }
                                appendPre(file.name + ' (' + file.id + ')')
                            }
                        } else {
                            appendPre('No files found.')
                        }
                    })
            }
        </script>
        <script
            async
            defer
            src="https://apis.google.com/js/api.js"
            onload="this.onload=function(){};gapi.load('client:auth2', initClient)"
            onreadystatechange="if (this.readyState === 'complete') this.onload()"
        ></script>
    </body>
</html>
